#!/usr/bin/perl -l
open F, 'uploads/'.$ARGV[0] or die;$_.=$s while($s=<F>);/^((?:[^\n]|\n{1,2}(?!\n))*)(?=\n\n\n)(??{$title=$1})|\n\n\n((?:[^\n]|\n{1,2}(?!\n))*)(?=\n\n\n|$)(??{;;;$a[$i]=[split ("\n\n", $2)];$i++;;;})/gs;$test=$ARGV[0];$test=~s/(.*)\..../$1/;$"=', ';for(1..$i){  $q=$_;  for(1..@{$a[$q-1]}-1){    $a[$q-1]->[$_]=~s/\n/<br>/g;	$m[$q]=1 if $a[$q-1]->[$_]=~/^[*]/;    $c='NULL'; $c=1 if($a[$q-1]->[$_]=~s/^[*#](.*)$/$1/);    push @ans, "('$test', '$q', '$_', '$a[$q-1]->[$_]', $c)";  }}print "INSERT INTO tests (ID, test) VALUES ('$test', '$title');\n";for(1..$i){  push @ques, "('$test', '$_', '$a[$_-1]->[0]', ".($m[$_]==1?'NULL':1).")";}print "INSERT INTO questions (ID, Qn, Question, Multi) VALUES @ques;\n" ;print "INSERT INTO answers (ID, Qn, An, Answer, Correct) VALUES @ans;\n";